<!DOCTYPE html>
<html>
<head>
	<title>Climbing Wall Panels</title>
	<style type="text/css">
		* { margin: 0; padding: 0; }
		body {
			margin: 5px;
		}
		.board {
			display: inline-block;
			border: 1px solid black;
			margin: 10px;
		}
		.board,
		svg {
			width: 200px;
			height: 400px;
		}
		svg {
			height: 400px;
			fill: peru;
		}
		text {
			fill: black;
			font-size: 6px;
			pointer-events: none;
		}
		#info {
			position: fixed;
			top: 2px;
			right: 2px;
			padding: 10px;
			border: 1px solid black;
			border-radius: 2px;
			background-color: aliceblue;
		}
		#active-wall { text-transform: capitalize; }
		button {
			padding: 4px 6px;
		}

		.controls {
			position: fixed;
			bottom: 0;
			z-index: 9;
			width: 100%;
		}
		#rotate {
			width: calc(100% - 40px);
			margin: 10px 20px;
		}
	</style>
</head>
<body>
	<legend id="info">
		<p>Active Wall: <span id="active-wall">(none)</span></p>
		<button type="button" tabindex="1" onclick="deactivateSVG()">deselect wall</button>
	</legend>
	<section>
		<div class="board"></div>
		<div class="board"></div>
		<div class="board"></div>
		<div class="board"></div>
		<div class="board"></div>
		<div class="board"></div>
	</section>
	<div class="controls">
		<label>
			<p>Rotate</p>
			<input id="rotate" type="range" min="-180" max="180" step="1" list="angles" value="0" disabled/>
			<datalist id="angles">
				<option value="-180" label="-180°"/>
				<option value="-165"/>
				<option value="-150"/>
				<option value="-135" label="-135"/>
				<option value="-120"/>
				<option value="-105"/>
				<option value="-90" label="-90°"/>
				<option value="-75"/>
				<option value="-60"/>
				<option value="-45" label="-45°"/>
				<option value="-30"/>
				<option value="-15"/>
				<option value="0" label="0°"/>
				<option value="15"/>
				<option value="30"/>
				<option value="45" label="45°"/>
				<option value="60"/>
				<option value="75"/>
				<option value="90" label="90°"/>
				<option value="105"/>
				<option value="120"/>
				<option value="135" label="135°"/>
				<option value="150"/>
				<option value="165"/>
				<option value="180" label="180°"/>
			</datalist>
		</label>
	</div>
	<section>
		<svg id="a1" viewbox="0 0 48 96">
			<polygon points="0,0 35.875,0 35.5625,48 0,48"/>
			<text x="16" y="24">A1</text>
		</svg>
		<svg id="a2" viewbox="0 0 48 96">
			<polygon points="0,0, 35.5625,0 35.25,48 0,48"/>
			<text x="16" y="24">A2</text>
		</svg>
		<svg id="a-kick" viewbox="0 0 48 96">
			<polygon points="0,0 48,0 48,16.25, 0,16.25"/>
			<text x="10" y="8">A kick</text>
		</svg>
		<svg id="d" viewbox="0 0 48 96">
			<polygon points="0,0 42.5,0 42.5,44"/>
			<text x="24" y="18">D</text>
		</svg>
		<svg id="e" viewbox="0 0 48 96">
			<polygon points="0,0 36.5,0 36.5,17.75 0,66.75"/>
			<text x="18" y="10">E</text>
		</svg>
		<svg id="b-left" viewbox="0 0 48 96">
			<polygon points="0,0 51,0 18.25,52 0,52"/>
			<text x="14" y="18">B-L</text>
		</svg>
		<svg id="b-center" viewbox="0 0 48 96">
			<polygon points="0,0 41.5,0 41.5,52 0,52"/>
			<text x="14" y="18">B-C</text>
		</svg>
		<svg id="b-right" viewbox="0 0 48 96">
			<polygon points="0,0 36.75,0 36.75,52"/>
			<text x="18" y="18">B-R</text>
		</svg>
		<svg id="c-top" viewbox="0 0 48 96">
			<polygon points="0,0 0,54 33.044,21.64"/>
			<text x="10" y="26">C-T</text>
		</svg>
	</section>
</body>
<script type="text/javascript">
	const svgs = document.querySelectorAll('svg'),
				svgLen = svgs.length,
				activeWall = document.getElementById('active-wall'),
				rotation = document.getElementById('rotate');

	let activeSVG = null,
			boundingRect = null,
			clickOffsetX = 0,
			clickOffsetY = 0,
			dragStartX = 0,
			dragStartY = 0;

	function activateSVG(e) {
		if (activeSVG !== e.currentTarget.parentElement) {
			activeSVG = e.currentTarget.parentElement;
			activeWall.innerText = activeSVG.id;
		}
		if (rotation.getAttribute('disabled') !== null) {
			rotation.removeAttribute('disabled');
		}
		boundingRect = activeSVG.getBoundingClientRect();
		clickOffsetX = e.pageX;
		clickOffsetY = e.pageY;
		dragStartX = boundingRect.x - e.x + e.pageX,
		dragStartY = boundingRect.y - e.y + e.pageY,
		activeSVG.style.transformOrigin = `${e.layerX}px ${e.layerY}px`;
		window.addEventListener('mousemove', dragSVG);
	}

	function deactivateSVG() {
		activeSVG = null;
		activeWall.innerText = '(none)';
		rotation.setAttribute('disabled', true);
	}

	function dragSVG(e) {
		if (!activeSVG) {
			return window.removeEventListener('mousemove', dragSVG);
		}
		const deltaX = e.pageX - clickOffsetX,
					deltaY = e.pageY - clickOffsetY
		activeSVG.style.top = `${dragStartY + deltaY}px`;
		activeSVG.style.left = `${dragStartX + deltaX}px`;
	}

	function nudgeSVG(e) {
		if (!activeSVG || !e.key.match('Arrow')) {
			return false;
		}
		e.preventDefault();

		const svgPos = {
						top: parseInt(activeSVG.style.top),
						left: parseInt(activeSVG.style.left),
					},
					delta = e.shiftKey
						? 20
						: e.altKey
							? 1
							: 5;

		switch(e.key) {
			case 'ArrowUp':
				activeSVG.style.top = `${svgPos.top - delta}px`;
				break;
			case 'ArrowDown':
				activeSVG.style.top = `${svgPos.top + delta}px`;
				break;
			case 'ArrowLeft':
				activeSVG.style.left = `${svgPos.left - delta}px`;
				break;
			case 'ArrowRight':
				activeSVG.style.left = `${svgPos.left + delta}px`;
				break;
		}
	}

	function rotateSVG(e) {
		if (!activeSVG) {
			return false;
		}
		activeSVG.style.transform = `rotate(${e.currentTarget.value}deg)`;
	}

	// start at the top of the page
	window.scrollTo(0,0);
	// init SVGs for movement
	for (let i = svgLen - 1; i >= 0; i--) {
		svgs[i].querySelector('polygon').addEventListener('mousedown', activateSVG);
		boundingRect = svgs[i].getBoundingClientRect();
		svgs[i].style.top = `${boundingRect.y}px`;
		svgs[i].style.left = `${boundingRect.x}px`;
		svgs[i].style.position = 'absolute';
	}

	window.addEventListener('mouseup', () => {
		window.removeEventListener('mousemove', dragSVG);
	});
	window.addEventListener('keydown', nudgeSVG);
	rotation.addEventListener('input', rotateSVG);
</script>
</html>